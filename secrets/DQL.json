{
    "commit_counts":        "SELECT author_email, COUNT(DISTINCT sha) AS commits_made FROM commits_{owner}_{repo} GROUP BY author_email ORDER BY COUNT(DISTINCT sha) DESC LIMIT 5;",
    "commit_heatmap":       "SELECT w.day_desc AS week_day, strftime('%H', commit_time) AS hour, COUNT(DISTINCT sha) AS commits_made FROM commits_{owner}_{repo} t INNER JOIN weekday w ON strftime('%w', t.commit_time) = w.day_number GROUP BY w.day_desc, strftime('%H', t.commit_time) ORDER BY w.day_desc, strftime('%H', t.commit_time) LIMIT 5;",
    "commit_heatmap_v2":    "SELECT w.day_desc AS week_day, b.bucket_desc as time_of_day, COUNT(DISTINCT sha) AS commits_made FROM commits_{owner}_{repo} t INNER JOIN weekday w ON strftime('%w', t.commit_time) = w.day_number INNER JOIN buckets b ON strftime('%H', t.commit_time) BETWEEN b.start AND b.end GROUP BY w.day_desc, b.bucket_desc ORDER BY w.day_desc, b.bucket_desc;",
    "commit_streak":        "SELECT author_email, DATE(commit_time) FROM commits_{owner}_{repo};",
    "commit_streak_v2":     "with temp_table as \n(\nselect author_email, streak_number, count(distinct commit_date) as streak_count\nfrom\n(\nSELECT author_email, commit_date, SUM(runtot) OVER(PARTITION BY author_email ORDER BY commit_date asc) AS streak_number\nfrom\n(\nSELECT \n    author_email, DATE(commit_time) as commit_date, \n    CASE WHEN DATE(DATE(commit_time), '-1 DAY') = LAG(DATE(commit_time)) OVER (PARTITION BY author_email ORDER BY DATE(commit_time) asc) THEN 0 ELSE 1 END as runtot\nFROM commits_{owner}_{repo} GROUP BY author_email, DATE(commit_time)\n) x\n) y\ngroup by 1, 2\n) \n\nselect t1.author_email, t1.streak_count as longest_streak\nfrom \ntemp_table t1\ninner join \n(\nselect \nmax(streak_count) as max_streak_count\nfrom temp_table\n) t2 \non t1.streak_count = t2.max_streak_count\ngroup by t1.author_email, t1.streak_count\n;",
    "commit_streak_check":  "SELECT author_email, commit_time FROM commits_{owner}_{repo} WHERE author_email IN ('562969+IAL32@users.noreply.github.com', 'jarek@potiuk.com') ORDER BY author_email, commit_time;"
}